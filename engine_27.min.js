if(typeof BIJELI=="undefined"){BIJELI=1,CRNI=-1,PRAZNO=0,BIJELA_DAMA=2,CRNA_DAMA=-2}if(typeof _draughts_engines=="undefined"){var _draughts_engines=[]}if(typeof draughts_engine=="undefined"){var draughts_engine=function(b,a){if(typeof a!="undefined"){_draughts_engines[b]=a}return _draughts_engines[b]}}if(typeof _draughts_engines[27]=="undefined"){(function(){var q=function(){if(arguments.length>2){if(arguments[0]%2==0==arguments[1]%2==0){return{active:false,black:false}}else{return{active:true,black:true,number:arguments[2]?((11-arguments[0])*6+Math.floor((11-arguments[1])/2)):(arguments[0]*6+Math.floor(arguments[1]/2))}}}else{var s=Math.floor(arguments[0]/6);var r=(arguments[0]%6)*2;if(s%2==0){++r}return arguments[1]?{row:11-s,column:11-r,black:true}:{row:s,column:r,black:true}}};var h=[[-1,-1,6,7],[-1,-1,7,8],[-1,-1,8,9],[-1,-1,9,10],[-1,-1,10,11],[-1,-1,11,-1],[-1,0,-1,12],[0,1,12,13],[1,2,13,14],[2,3,14,15],[3,4,15,16],[4,5,16,17],[6,7,18,19],[7,8,19,20],[8,9,20,21],[9,10,21,22],[10,11,22,23],[11,-1,23,-1],[-1,12,-1,24],[12,13,24,25],[13,14,25,26],[14,15,26,27],[15,16,27,28],[16,17,28,29],[18,19,30,31],[19,20,31,32],[20,21,32,33],[21,22,33,34],[22,23,34,35],[23,-1,35,-1],[-1,24,-1,36],[24,25,36,37],[25,26,37,38],[26,27,38,39],[27,28,39,40],[28,29,40,41],[30,31,42,43],[31,32,43,44],[32,33,44,45],[33,34,45,46],[34,35,46,47],[35,-1,47,-1],[-1,36,-1,48],[36,37,48,49],[37,38,49,50],[38,39,50,51],[39,40,51,52],[40,41,52,53],[42,43,54,55],[43,44,55,56],[44,45,56,57],[45,46,57,58],[46,47,58,59],[47,-1,59,-1],[-1,48,-1,60],[48,49,60,61],[49,50,61,62],[50,51,62,63],[51,52,63,64],[52,53,64,65],[54,55,66,67],[55,56,67,68],[56,57,68,69],[57,58,69,70],[58,59,70,71],[59,-1,71,-1],[-1,60,-1,-1],[60,61,-1,-1],[61,62,-1,-1],[62,63,-1,-1],[63,64,-1,-1],[64,65,-1,-1]];var b=function(r){return Number(r+1).toString(10)},n=function(r){return parseInt(r,10)-1},f=function(r){if(r==0){return 0}else{if(r>0){return 1}else{return -1}}},l=function(r){return r.split(/\D+/)},g=function(r){var u=l(r);var t=[];for(var w=0;w<u.length;++w){var v=u[w];if(!v){return[]}t.push(n(v))}return t},d=function(s,t){if(s[0]!=t[0]){return false}var r=1;for(var u=1;u<s.length;++u){while(s[u]!=t[r++]){if(r>=t.length){return false}}}return r==t.length},k=function(s,r){var G=Math.min(s.length,r.length);var L=[];for(var K=0;K<G;++K){var I=s[K];L.push({sq:I,l:q(I,false),r:q(r[K],false)})}var u=L.shift();var v=u.l;var N=u.r;var O=[[u.sq]];while(L.length>0){var w=L.shift();var J=w.sq;var M=w.l;var D=w.r;var E=[];var t=f(M.column-v.column);var B=f(M.row-v.row);if(t==f(D.column-M.column)&&B==f(D.row-M.row)){var A=N.column+t;var z=N.row+B;var E=[];while(A!=D.column||z!=D.row){var F=q(z,A,false);A+=t;z+=B;for(var H=0;H<O.length;++H){E.push(O[H].concat(F.number))}}}else{for(var H=0;H<O.length;++H){E.push(O[H].concat(J))}}v=M;N=D;O=E}var E=[];var C=s[s.length-1];for(var H=0;H<O.length;++H){E.push(O[H].concat(C))}return E},p=function(x,r){var y=g(x);if(y.length<2){return -11}var z=-12;for(var w=0;w<r.length;++w){var u=r[w];var B=g(u.fullDisplay());if(B[0]!=y[0]||B[B.length-1]!=y[y.length-1]){continue}var v=k(B,u.preko);var t=false;for(var A=0;A<v.length;++A){if(d(y,v[A])){if(t){t=false;break}else{t=true}}}if(t){if(z<0){z=w}else{return -13}}}return z},j=function(r){var s,v,t,u;if(!r){s=[];v=0;while(v<72){s[v++]=0}return s}if(r instanceof Array){return r}if(r.length==36){s=[];for(v=t=0;t<36;++t){u=r.charCodeAt(t)-64;s[v++]=Math.floor(u/5-2);s[v++]=u%5-2}return s}else{if(r.length==72){s=[];for(t=0;t<72;++t){s[t]=r.charCodeAt(t)-67}return s}else{return null}}},o=function(r,s){if(r==1&&s<6){return 2}else{if(r==-1&&s>=66){return -2}else{return r}}};var e=function(u,t){if(typeof u=="string"){u=j(u)}function z(G,D,B){var C=G,A=D,F=B||[];if(B&&B.length){var H=b(C);for(var I=0;I<B.length;++I){H+="x"+b(B[I].e);B[I]=B[I].c}}else{var H=b(C)+"-"+b(A)}var E=function(){return b(G)+(B==null||B.length==0?"-":"x")+b(D)};return{sa:C,na:A,preko:F||[],toString:E,display:E,fullDisplay:function(){return H}}}function y(B,A){return A?{head:B,tail:A,length:1+A.length}:{head:null,tail:null,length:0}}function v(C,B,A){return{from:C,to:B,over:A,length:A.length}}var s=new y(null,null);var x=function(E,C){var I=C?1:-1,F,G,D,A=[];for(F=0;F<72;++F){var B=h[F];if(E[F]==I){var J=I==1?[0,1]:[2,3];for(var H=0;H<J.length;++H){D=B[J[H]];if(D>=0){if(E[D]==0){A.push(new z(F,D))}}}}else{if(E[F]==2*I){for(G=0;G<4;++G){D=B[G];while(D>=0&&E[D]==0){A.push(new z(F,D));D=h[D][G]}}}}}return A};var w=function(D,F){var K=function(ag,ah){var aj=[],ac=h[ah],an=ag[ah];var af=an==1?42:-42;var ai;for(ai=0;ai<4;++ai){var ad=ac[ai];var am=false,ak=[];if(ad>=0&&an*ag[ad]<0){var aa=h[ad][ai];if(aa>=0&&ag[aa]==0){var ae=[].concat(ag);ae[aa]=an;ae[ad]=af;ae[ah]=0;var al=K(ae,aa);if(al&&al.length>0){for(var ao=0;ao<al.length;++ao){var ab=al[ao];var Z=new v(ah,ab.to,new y({c:ad,e:aa},ab.over));ak.push(Z)}am=true}else{ak.push(new v(ah,aa,new y({c:ad,e:aa},s)))}}}if(am){for(var ao=0;ao<ak.length;++ao){if(ak[ao].length>1){aj.push(ak[ao])}}}else{for(var ao=0;ao<ak.length;++ao){aj.push(ak[ao])}}}return aj};var H=function(ag,ah){var ad=h[ah],an=ag[ah],aj=[],ai;var af=an==2?42:-42;for(ai=0;ai<4;++ai){var am=false,ak=[],ac=ad[ai],aa;while(ac>=0&&ag[ac]==0){ac=h[ac][ai]}if(ac<0||an*ag[ac]>0){continue}aa=h[ac][ai];while(aa>=0&&ag[aa]==0){var ae=[].concat(ag);ae[aa]=an;ae[ac]=af;ae[ah]=0;var al=H(ae,aa);if(al&&al.length>0){for(var ao=0;ao<al.length;++ao){var ab=al[ao];var Z=new v(ah,ab.to,new y({c:ac,e:aa},ab.over));ak.push(Z)}am=true}else{ak.push(new v(ah,aa,new y({c:ac,e:aa},s)))}aa=h[aa][ai]}if(am){for(var ao=0;ao<ak.length;++ao){if(ak[ao].length>1){aj.push(ak[ao])}}}else{for(var ao=0;ao<ak.length;++ao){aj.push(ak[ao])}}}return aj};var Y=function(Z,ad,aa){if(ad==null||ad.length==0){return}for(var ah=0;ah<ad.length;++ah){var ac=ad[ah];var ag=[];var ae=ac.over;var ab=0;while(ae!=s){ag.push(ae.head);ae=ae.tail}var af=new z(ac.from,ac.to,ag);Z.push(af)}};var O,T,C,G,A,P,V,X,J,U,I,R,L=F?1:-1,E=[];for(var N=0;N<72;++N){var B=D[N];if(B==L){Y(E,K(D,N),false)}else{if(B==2*L){Y(E,H(D,N),true)}}}if(E.length>1){var X=[];var S=E[0].preko.length;for(var O=0;O<E.length;++O){var M=E[O];var Q=M.preko.length;if(S>Q){continue}if(S<Q){S=Q;X=[]}X.push(M)}E=X}for(O=0;O<E.length;++O){T=E[O];C=T.sa;G=T.na;A=T.preko;var W=A.length;for(P=O+1;P<E.length;++P){V=E[P];if(V.sa!=C||V.na!=G||W!=V.preko.length){continue}X=[].concat(V.preko);U=W;for(I=0;I<W;++I){R=A[I];for(J=0;J<U;++J){if(R==X[J]){X[J--]=X[--U]}}}X=null;if(U==0){E.splice(P--,1)}}}return E};var r=w(u,t);if(r.length==0){r=x(u,t)}listaMogucihPoteza=r;return r};var a=function(r){r.whiteMove=!r.whiteMove;if(r.whiteMove){r.num++}};var c=function(r,s){var t=function(v){var x=function(D){var J=-1,A=s.length,C,z,G,F,H,I,B,E;G=D.split("x");while(--A>=0){C=s[A];z=C.fullDisplay();if(D==z){return A}else{F=z.split("x");H=false;if(G[0]==(F[0])&&G[G.length-1]==(F[F.length-1])){I=0;H=true;for(B=1;B<G.length-1;++B){E=F.indexOf(G[B],I+1);if(E<0){H=false;break}I=E}}if(H){if(J>=0){return -1}else{J=A}}else{if(D==(C.display())){if(J>=0){return -1}else{J=A}}}}}if(J<0){}return J};var y=x(v);if(y<0){y=x(v.replace(":","x"))}if(y<0){y=x(v.replace("-","x"))}if(y<0){y=x(v.replace(":","-"))}if(y<0){y=x(v.replace("x","-"))}if(y<0){y=p(v,s)}if(y<0){try{log("Error: "+v);log(s)}catch(w){}}return y};var u=t(r);return u<0?null:s[u]};var m=function(r,C,u){var z;if(typeof C=="string"){throw new Error("Position as string not supported (?) : "+C)}else{z=C}if(typeof r=="string"){r=c(r,e(z,u))}if(r==null){try{log("Error#0")}catch(w){}return null}var A,D,E,y,B,v,t;A=r.na;D=r.sa;if((z[A]!=0)&&D!=A){try{log("Error#1")}catch(w){}return null}E=u?1:-1;if(z[D]!=E&&z[D]!=2*E){try{log("Error#2: "+D+"["+z[D]+"] ("+E+")");log(z)}catch(w){}return null}y=r.preko;if(y!=null){B=E==1?-1:1;v=y.length;while(--v>=0){if(z[y[v]]!=B&&z[y[v]]!=2*B){try{log("Error#3")}catch(w){}return null}}}var x={};x[A]=z[A]=o(z[D],A);if(D!=A){x[D]=z[D]=0}if(y!=null){v=y.length;while(--v>=0){var s=y[v];if(s!=A){x[s]=z[s]=0}}}return{move:r,position:z,changed:x}};var i={splitFullDisplay:l,splitIntoSquares:g,matchCaptureMove:d,handleOneMove:k,longRangeKingCaptureMoveIndex:p,gameType:27,rows:12,columns:12,squares:72,piecesPerSide:30,firstMoveWhite:true,immediatePromotion:false,turkishCapture:false,captureSeparator:"x",encodeSquare:b,decodeSquare:n,initialPosition:function(){var r=new Array(72),s;for(s=0;s<30;r[s++]=-1){}for(s=30;s<42;r[s++]=0){}for(s=42;s<72;r[s++]=1){}return r},packPosition:function(r){var t="",s;for(s=0;s<72;s+=2){t=t.concat(String.fromCharCode((64+(r[s]+2)*5+r[s+1]+2)))}return t},unpackPosition:j,possibleMoves:e,validMoves:e,findMove:c,makeMove:m,advanceMove:a,checkForPromotion:o,mapping:q};draughts_engine(27,i);draughts_engine("canadian",i);return i})()};